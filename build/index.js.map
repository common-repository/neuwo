{"version":3,"file":"index.js","mappings":";;;;;;;;;;;;;;;AAAO,MAAMA,MAAM,GAAIC,GAAD,IAAS;EAC3B,OAAO;IACHC,IAAI,EAAE,SADH;IAEHD;EAFG,CAAP;AAIH,CALM;AAOA,MAAME,YAAY,GAAIC,SAAD,IAAe;EACvC,OAAO;IACHF,IAAI,EAAE,eADH;IAEHE;EAFG,CAAP;AAIH,CALM;;;;;;;;;;;;;;;;CCLP;AACA;AAEA;;AACO,MAAME,SAAS,GAAIC,MAAD,IAAY;EACjC,OAAO;IACHL,IAAI,EAAE,YADH;IAEHK;EAFG,CAAP;AAIH,CALM,EAOP;;AACA,+DAAe;EACXC,UAAU,OAAW;IAAA,IAAV;MAACD;IAAD,CAAU;IACjB,MAAME,IAAI,GAAGJ,2DAAQ,CAAE;MAAEK,IAAI,EAAE,8BAA8BH;IAAtC,CAAF,CAAR,CAA2DI,IAA3D,CAAmEC,QAAF,IAAgBA,QAAjF,CAAb;IACA,OAAOH,IAAP;EACH;;AAJU,CAAf;;;;;;;;;;;;;;;;ACdA;CAC0C;AAE1C;;AACO,UAAUI,OAAV,GAAmB;EACtB,MAAMN,MAAM,GAAG,MAAMO,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8BC,gBAA9B,EAArB;EACA,MAAMC,OAAO,GAAG,MAAMZ,oDAAS,CAACC,MAAD,CAA/B;;EACA,IAAIW,OAAO,KAAK,EAAhB,EAAmB;IACfC,OAAO,CAACC,GAAR,CAAY,qBAAZ;IACA;EACH;;EACD,OAAOjB,sDAAY,CAACe,OAAD,CAAnB;AACH;;;;;;;;;;;;;;ACZM,MAAML,OAAO,GAAIQ,KAAD,IAAW;EAC9B,OAAOA,KAAP;AACH,CAFM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAP;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;CAGA;;AAEA,MAAMe,aAAa,GAAG;EACrBC,IAAI,EAAE,EADe;EAErBC,YAAY,EAAE;IAAEC,QAAQ,EAAE,EAAZ;IAAgBC,aAAa,EAAE;EAA/B,CAFO;EAGrBC,oBAAoB,EAAE;IACrBC,UAAU,EAAE,EADS;IAErBC,UAAU,EAAE;EAFS;AAHD,CAAtB;AASA,MAAMC,KAAK,GAAGd,iEAAgB,CAAC,OAAD,EAAU;EACvCe,OAAO,GAA+B;IAAA,IAA9BxB,KAA8B,uEAAtBe,aAAsB;IAAA,IAAPU,MAAO;;IACrC,QAAQA,MAAM,CAAC5C,IAAf;MACC,KAAK,SAAL;QACC,OAAO,EAAC,GAAGmB,KAAJ;UAAWgB,IAAI,EAAE,CAAC,GAAGhB,KAAK,CAACgB,IAAV,EAAgBS,MAAM,CAAC7C,GAAvB;QAAjB,CAAP;MAAuD;;MACxD,KAAK,eAAL;QACC,OAAO,EAAC,GAAG6C,MAAM,CAAC1C;QAAX,CAAP;;MACD;QACC,OAAOiB,KAAP;IANF;EAQA,CAVsC;;EAWvCY,OAXuC;EAYvCD,SAZuC;EAavCE,SAbuC;EAa3B;EACZC,QAduC,oDAc7B;;AAd6B,CAAV,CAA9B;AAiBAJ,yDAAQ,CAACa,KAAD,CAAR;;AAGA,MAAMG,oBAAoB,GAAG,MAAM;EAClC,MAAM,CAAEC,OAAF,EAAWC,UAAX,IAA0BrB,4DAAQ,CAAC,KAAD,CAAxC;EAEA,MAAMxB,SAAS,GAAGyB,0DAAS,CAAEb,MAAD,IAAY;IACvC,MAAMkC,UAAU,GAAGlC,MAAM,CAAC,OAAD,CAAzB;IACA,OAAOkC,UAAU,IAAIA,UAAU,CAACrC,OAAX,EAArB;EACA,CAH0B,EAGxB,EAHwB,CAA3B,CAHkC,CAM1B;;EAER,MAAM,CAAEsC,SAAF,EAAaC,YAAb,IAA8BxB,4DAAQ,CAAC,EAAD,CAA5C,CARkC,CAQiB;;EAEnD,OAEC,kEAAC,4EAAD;IAA4B,KAAK,EAAC,mBAAlC;IAAsD,IAAI,EAAC;EAA3D,GAEC,kEAAC,yDAAD;IACA,OAAO,EAAC,WADR;IAEA,QAAQ,EAAEoB,OAFV;IAGA,OAAO,EACN,YAAW;MACVC,UAAU,CAAC,IAAD,CAAV;MACAnC,EAAE,CAACC,IAAH,CAAQsC,QAAR,CAAiB,aAAjB,EAAgCC,QAAhC,GAA2C3C,IAA3C,CAAgD,YAAU;QACzD,MAAMJ,MAAM,GAAGO,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8BuC,cAA9B,GAA+CC,EAA9D,CADyD,CAEzD;;QAEAnD,2DAAQ,CAAE;UAAEK,IAAI,EAAE,kCAAkCH;QAA1C,CAAF,CAAR,CAA+DI,IAA/D,CAAuEO,OAAF,IAAe;UACnF;UACA;UACAJ,EAAE,CAACC,IAAH,CAAQsC,QAAR,CAAiB,OAAjB,EAA0BlD,YAA1B,CAAuCe,OAAvC;UACA+B,UAAU,CAAC,KAAD,CAAV;QACA,CALD;MAMA,CAVD;IAWA;EAjBF,kBAFD,EAsBED,OAAO,IAAI,kEAAC,0DAAD,OAtBb,EAwBC;IAAK,EAAE,EAAC;EAAR,GACE5C,SAAS,CAACiC,IAAV,IAAkBjC,SAAS,CAACiC,IAAV,CAAeoB,MAAf,KAA0B,CAA7C,IACA;IAAK,EAAE,EAAC;EAAR,GACC,8EAAI,8FAAJ,CADD,EAGC,8EACErD,SAAS,CAACiC,IAAV,CAAeqB,GAAf,CAAmBzD,GAAG,IACtB;IAAI,GAAG,EAAEA,GAAG,CAAC0D;EAAb,GAAqB1D,GAAG,CAAC0D,KAAzB,OAAgC;IAAM,SAAS,EAAC;EAAhB,GAAmC1D,GAAG,CAAC2D,KAAvC,CAAhC,EACA,kEAAC,yDAAD;IAAQ,SAAS,EAAC,+CAAlB;IACE,QAAQ,EAAG3D,GAAG,CAAC4D,WAAJ,IAAmBV,SAAS,CAACW,QAAV,CAAmB7D,GAAG,CAAC0D,KAAvB,CADhC;IAEE,OAAO,EACN,YAAU;MACTV,UAAU,CAAC,IAAD,CAAV;MACA,MAAMc,SAAS,GAAGjD,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8BgD,sBAA9B,CAAqD,MAArD,CAAlB;;MACA,IAAI/D,GAAG,CAACgE,OAAR,EAAgB;QAAG;QAElB,MAAMC,aAAa,GAAGH,SAAS,CAACI,MAAV,CAAiB,CAAClE,GAAG,CAACgE,OAAL,CAAjB,CAAtB;QACAb,YAAY,CAACD,SAAS,CAACgB,MAAV,CAAiBlE,GAAG,CAAC0D,KAArB,CAAD,CAAZ;QACA7C,EAAE,CAACC,IAAH,CAAQsC,QAAR,CAAiB,aAAjB,EAAgCe,QAAhC,CAAyC;UAAC/B,IAAI,EAAE6B;QAAP,CAAzC,EAAgEvD,IAAhE,CAAqE,MAAM;UAC1EsC,UAAU,CAAC,KAAD,CAAV,CAD0E,CAE1E;UACA;QACA,CAJD;MAMA,CAVD,MAUO;QAAG;QACTnC,EAAE,CAACC,IAAH,CAAQsC,QAAR,CAAiB,MAAjB,EAAyBgB,gBAAzB,CAA0C,UAA1C,EAAsD,UAAtD,EAAkE;UAACC,IAAI,EAAErE,GAAG,CAAC0D;QAAX,CAAlE,EAAqFhD,IAArF,CAA0F,UAAS4D,GAAT,EAAa;UACtG,IAAIA,GAAJ,EAAQ;YACP,MAAMC,QAAQ,GAAGD,GAAG,CAACf,EAArB;YACA,MAAMU,aAAa,GAAGH,SAAS,CAACI,MAAV,CAAiB,CAACK,QAAD,CAAjB,CAAtB;YACApB,YAAY,CAACD,SAAS,CAACgB,MAAV,CAAiBlE,GAAG,CAAC0D,KAArB,CAAD,CAAZ;YACA7C,EAAE,CAACC,IAAH,CAAQsC,QAAR,CAAiB,aAAjB,EAAgCe,QAAhC,CAAyC;cAAC/B,IAAI,EAAE6B;YAAP,CAAzC,EAAgEvD,IAAhE,CAAqE,MAAM;cAC1E;cACA;cACAG,EAAE,CAACC,IAAH,CAAQsC,QAAR,CAAiB,OAAjB,EAA0BoB,oBAA1B,CAA+C,SAA/C,EAA0D9D,IAA1D,CAA+D,MAAM;gBAAG;gBACvEsC,UAAU,CAAC,KAAD,CAAV,CADoE,CAEpE;gBACA;cACA,CAJD;YAKA,CARD;UASA,CAbD,MAaO;YACN9B,OAAO,CAACC,GAAR,CAAY,qIAAZ;YACA6B,UAAU,CAAC,KAAD,CAAV;UACA;QACD,CAlBD;MAmBA;IACD;EArCJ,OADA,CADA,CADF,CAHD,CAFD,EAsDG7C,SAAS,CAACkC,YAAV,IAA0BlC,SAAS,CAACkC,YAAV,CAAuBE,aAAlD,IACD;IAAK,EAAE,EAAC;EAAR,GACC,6FADD,EAEC,6EAAIpC,SAAS,CAACkC,YAAV,CAAuBE,aAA3B,CAFD,EAGC,6EAAG;IAAM,SAAS,EAAC;EAAhB,GAAmCpC,SAAS,CAACkC,YAAV,CAAuBC,QAA1D,CAAH,CAHD,CAvDD,EA+DGnC,SAAS,CAACqC,oBAAV,IACArC,SAAS,CAACqC,oBAAV,CAA+BC,UAD/B,IAEAtC,SAAS,CAACqC,oBAAV,CAA+BC,UAA/B,CAA0Ce,MAA1C,KAAqD,CAFtD,IAGD;IAAK,EAAE,EAAC;EAAR,GACE,yGADF,EAGE,uFAHF,EAKE,8EACErD,SAAS,CAACqC,oBAAV,CAA+BC,UAA/B,IAA6CtC,SAAS,CAACqC,oBAAV,CAA+BC,UAA/B,CAA0CgB,GAA1C,CAA8CgB,GAAG,IAC9F;IAAI,GAAG,EAAEA,GAAG,CAACf;EAAb,GAAqBe,GAAG,CAACC,EAAzB,OAA8BD,GAAG,CAACE,KAAlC,OAAyC;IAAM,SAAS,EAAC;EAAhB,GAAmCF,GAAG,CAACG,SAAvC,CAAzC,CAD6C,CAD/C,CALF,EAUE,uFAVF,EAYE,8EACEzE,SAAS,CAACqC,oBAAV,CAA+BE,UAA/B,IAA6CvC,SAAS,CAACqC,oBAAV,CAA+BE,UAA/B,CAA0Ce,GAA1C,CAA8CgB,GAAG,IAC9F;IAAI,GAAG,EAAEA,GAAG,CAACf;EAAb,GAAqBe,GAAG,CAACC,EAAzB,OAA8BD,GAAG,CAACE,KAAlC,OAAyC;IAAM,SAAS,EAAC;EAAhB,GAAmCF,GAAG,CAACG,SAAvC,CAAzC,CAD6C,CAD/C,CAZF,CAlED,CAxBD,CAFD;AAoHA,CA9HD;;AAiIA,MAAMC,4BAA4B,GAAG,MAAM;EAC1C,MAAMC,QAAQ,GAAGlD,0DAAS,CAAEb,MAAD,IAAY;IACtC,OAAOA,MAAM,CAAC,aAAD,CAAN,CAAsBgD,sBAAtB,CAA6C,MAA7C,CAAP;EACA,CAFyB,CAA1B;EAGA,MAAM,CAAEhB,OAAF,EAAWC,UAAX,IAA0BrB,4DAAQ,CAAC,KAAD,CAAxC;EACA,MAAM,CAACoD,SAAD,EAAYC,UAAZ,IAA0BrD,4DAAQ,CAAEmD,QAAQ,CAACG,6BAAX,CAAxC;EACA,OACC,kEAAC,sEAAD,QACC,kEAAC,kEAAD;IACA,KAAK,EAAC,gCADN;IAEA,QAAQ,EAAElC,OAFV;IAGA,OAAO,EAAEgC,SAHT;IAIA,QAAQ,EAAGG,QAAD,IAAc;MACvB,MAAM5E,MAAM,GAAGO,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8BuC,cAA9B,GAA+CC,EAA9D,CADuB,CAEvB;;MACAP,UAAU,CAAC,IAAD,CAAV;MAEA5C,2DAAQ,CAAC;QAAGK,IAAI,EAAE,iCAAT;QAA4C0E,MAAM,EAAE,MAApD;QACNrE,IAAI,EAAE;UAACsE,OAAO,EAAEF,QAAQ,CAACG,QAAT,EAAV;UAA+B/E,MAAM,EAAEA,MAAM,CAAC+E,QAAP;QAAvC;MADA,CAAD,CAAR,CAEK3E,IAFL,CAEWO,OAAD,IAAa;QACpB;QACA;QACC+D,UAAU,CAAC/D,OAAD,CAAV;QACA+B,UAAU,CAAC,KAAD,CAAV;MACA,CAPJ;IASA;EAlBD,EADD,CADD;AAwBA,CA9BD;;AAgCA3B,kEAAc,CAAC,iBAAD,EAAoB;EACjCiE,MAAM,EAAE,MAAM;IACb,OACC,kIAEA,kEAAC,oBAAD,OAFA,EAGA,kEAAC,4BAAD,OAHA,CADD;EAQA;AAVgC,CAApB,CAAd,EAcA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,YAAT,GAAwB;EAEvB;EACA,MAAMC,QAAQ,GAAG3E,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8BwE,YAA9B,MAAgD1E,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8B0E,gBAA9B,EAAjE;EACA,MAAMC,UAAU,GAAG7E,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8B4E,oBAA9B,EAAnB;EACA,MAAMC,kBAAkB,GAAG/E,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8B6E,kBAA9B,EAA3B;EACA,MAAMC,uBAAuB,GAAGhF,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8B8E,uBAA9B,EAAhC;EACA,MAAMC,YAAY,GAAGjF,EAAE,CAACC,IAAH,CAAQC,MAAR,CAAe,aAAf,EAA8B0E,gBAA9B,EAArB;EACA,MAAMM,gBAAgB,GAAGP,QAAQ,IAAI,CAACE,UAAb,IAA2BE,kBAApD,CARuB,CAUvB;;EACA,MAAMI,MAAM,GAAG,CAACF,YAAD,IAAiBN,QAAhC;EACA,MAAMS,iBAAiB,GAAGF,gBAAgB,IAAI,CAAEF,uBAAhD;EAEA,OAAOG,MAAM,IAAIC,iBAAjB;AACE,EAEH;;;AACA,IAAIC,SAAS,GAAGX,YAAY,EAA5B;AAEA1E,EAAE,CAACC,IAAH,CAAQqF,SAAR,CAAmB,MAAM;EACxB;EACA,MAAMX,QAAQ,GAAGD,YAAY,EAA7B,CAFwB,CAIxB;;EACA,MAAMa,YAAY,GAAGF,SAAS,IAAI,CAACV,QAAnC,CALwB,CAOxB;;EACAU,SAAS,GAAGV,QAAZ;;EAEA,IAAKY,YAAL,EAAoB;IACnB;AACF;AACA;IAEE;IACA;IACA;IACA;IAEA;IACA;IACA;IACAvF,EAAE,CAACC,IAAH,CAAQsC,QAAR,CAAiB,OAAjB,EAA0BoB,oBAA1B,CAA+C,SAA/C;EAEA,CAzBuB,CAyBtB;;AAEF,CA3BD,GA2BI;;;;;;;;;;;AC3RJ;;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA,eAAe,4BAA4B;WAC3C,eAAe;WACf,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA,8CAA8C;;;;;WCA9C;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;ACNA;AACA","sources":["webpack://neuwo/./src/actions.js","webpack://neuwo/./src/controls.js","webpack://neuwo/./src/resolvers.js","webpack://neuwo/./src/selectors.js","webpack://neuwo/./src/sidebar.js","webpack://neuwo/./src/editor.scss","webpack://neuwo/external window [\"wp\",\"apiFetch\"]","webpack://neuwo/external window [\"wp\",\"components\"]","webpack://neuwo/external window [\"wp\",\"data\"]","webpack://neuwo/external window [\"wp\",\"editPost\"]","webpack://neuwo/external window [\"wp\",\"element\"]","webpack://neuwo/external window [\"wp\",\"plugins\"]","webpack://neuwo/webpack/bootstrap","webpack://neuwo/webpack/runtime/compat get default export","webpack://neuwo/webpack/runtime/define property getters","webpack://neuwo/webpack/runtime/hasOwnProperty shorthand","webpack://neuwo/webpack/runtime/make namespace object","webpack://neuwo/./src/index.js"],"sourcesContent":["export const addTag = (tag) => {\n    return {\n        type: 'ADD_TAG',\n        tag\n    }\n};\n\nexport const populateData = (neuwoData) => {\n    return {\n        type: 'POPULATE_DATA',\n        neuwoData\n    }\n};","import apiFetch from '@wordpress/api-fetch';\n\n// \"Control Actions\" Required for resolver to send API request\n// Defines execution flow by specific type of action\n\n// Control Action Creator, when dispatched runs control function.\nexport const fetchData = (postId) => {\n    return {\n        type: 'FETCH_DATA',\n        postId\n    }\n}\n\n// Control Function, returns a promise\nexport default {\n    FETCH_DATA({postId}) {\n        const resp = apiFetch( { path: '/neuwo/v1/getData?postId=' + postId } ).then( ( response ) => response );\n        return resp;\n    }\n}","import { fetchData } from './controls'\nimport { populateData } from './actions'  // TODO move actions to file\n\n// Dispatching Control Action via Control Action Creator, pauses till resolves.\nexport function* getData(){\n    const postId = yield wp.data.select('core/editor').getCurrentPostId();\n    const apiData = yield fetchData(postId);\n    if (apiData === \"\"){\n        console.log(\"Neuwo data not set.\")\n        return;\n    }\n    return populateData(apiData);\n}\n","export const getData = (state) => {\n    return state;\n}","/* // eslint-disable no-console */\n\n/*\n * Known issues:\n * - Handles tags internally by converting to lowercase, may cause localisation issues for Turkish etc.\n *   See https://stackoverflow.com/questions/2140627/how-to-do-case-insensitive-string-comparison\n * - Tag quick add buttons can glitch when pressing multiple too fast\n */\n\nimport { registerPlugin } from '@wordpress/plugins';\nimport { PluginDocumentSettingPanel, PluginPostStatusInfo } from '@wordpress/edit-post';\nimport apiFetch from '@wordpress/api-fetch';\nimport { Button, CheckboxControl, Spinner } from '@wordpress/components';\nimport { useState } from '@wordpress/element';\nimport { useSelect, createReduxStore, register} from '@wordpress/data';\nimport * as selectors from './selectors'\nimport * as actions from './actions'\nimport * as resolvers from './resolvers'\nimport controls from './controls'\n\n// console.log( 'Running Neuwo Gutenberg Script for sidebar' );\n\nconst DEFAULT_STATE = {\n\ttags: [],\n\tbrand_safety: { BS_score: '', BS_indication: ''},\n\tmarketing_categories: {\n\t\tiab_tier_1: [],\n\t\tiab_tier_2: [],\n\t}\n}\n\nconst store = createReduxStore('neuwo', {\n\treducer(state = DEFAULT_STATE, action){\n\t\tswitch (action.type){\n\t\t\tcase 'ADD_TAG':\n\t\t\t\treturn {...state, tags: [...state.tags, action.tag]};  // for demo purposes\n\t\t\tcase 'POPULATE_DATA':\n\t\t\t\treturn {...action.neuwoData};\n\t\t\tdefault:\n\t\t\t\treturn state;\n\t\t}\n\t},\n\tactions,\n\tselectors,\n\tresolvers,  // Side effects for selectors\n\tcontrols  // API request \n})\n\nregister(store);\n\n\nconst NeuwoKeywordsControl = () => {\n\tconst [ loading, setLoading ] = useState(false);\n\n\tconst neuwoData = useSelect((select) => {\n\t\tconst neuwoStore = select('neuwo');\n\t\treturn neuwoStore && neuwoStore.getData();\n\t}, [])  // TODO runs many times, narrow down depencencies in [] to trigger less times\n\n\tconst [ addedTags, setAddedTags ] = useState([]);  // Would be better to be reseted during invalidateState after post save\n\n\treturn (\n\n\t\t<PluginDocumentSettingPanel title=\"Neuwo.ai Keywords\" icon=\"tag\">\n\n\t\t\t<Button \n\t\t\tvariant=\"secondary\"\n\t\t\tdisabled={loading}\n\t\t\tonClick={\n\t\t\t\tfunction (){\n\t\t\t\t\tsetLoading(true);\n\t\t\t\t\twp.data.dispatch('core/editor').savePost().then(function(){\n\t\t\t\t\t\tconst postId = wp.data.select('core/editor').getCurrentPost().id\n\t\t\t\t\t\t// console.log(\"Fetching AITopics for post \" + postId)\n\n\t\t\t\t\t\tapiFetch( { path: '/neuwo/v1/getAiTopics?postId=' + postId } ).then( ( apiData ) => {\n\t\t\t\t\t\t\t// console.log(\"neuwoData:\");\n\t\t\t\t\t\t\t// console.log(apiData);\n\t\t\t\t\t\t\twp.data.dispatch('neuwo').populateData(apiData);\n\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t} );\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}>Get keywords</Button>\n\n\t\t\t{loading && <Spinner/>}\n\t\t\t\t\n\t\t\t<div id=\"neuwoDataDiv\">\n\t\t\t{(neuwoData.tags && neuwoData.tags.length !== 0) &&\n\t\t\t\t<div id=\"neuwoAiTopics\">\n\t\t\t\t\t<h4><strong>AI Topics</strong></h4>\n\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t{neuwoData.tags.map(tag => (\n\t\t\t\t\t\t\t<li key={tag.value}>{tag.value} <span className=\"neuwo_tag_score\">{tag.score}</span>\n\t\t\t\t\t\t\t<Button className=\"button gutenberg_neuwo_add_keyword_as_tag_btn\" \n\t\t\t\t\t\t\t\t\tdisabled={ tag.addedToPost || addedTags.includes(tag.value) } \n\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\tfunction(){\n\t\t\t\t\t\t\t\t\t\t\tsetLoading(true);\n\t\t\t\t\t\t\t\t\t\t\tconst oldTagIds = wp.data.select('core/editor').getEditedPostAttribute('tags');\n\t\t\t\t\t\t\t\t\t\t\tif (tag.WPTagId){  // Tag exists in WP and ID will be reused\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst updatedTagIds = oldTagIds.concat([tag.WPTagId])\n\t\t\t\t\t\t\t\t\t\t\t\tsetAddedTags(addedTags.concat(tag.value));\n\t\t\t\t\t\t\t\t\t\t\t\twp.data.dispatch('core/editor').editPost({tags: updatedTagIds}).then(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(\"addedTags\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(addedTags)\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t} else {  // Tag is new in WP and needs to be created before it has ID\n\t\t\t\t\t\t\t\t\t\t\t\twp.data.dispatch('core').saveEntityRecord('taxonomy', 'post_tag', {name: tag.value}).then(function(val){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (val){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst newTagId = val.id\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst updatedTagIds = oldTagIds.concat([newTagId])\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetAddedTags(addedTags.concat(tag.value));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twp.data.dispatch('core/editor').editPost({tags: updatedTagIds}).then(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// invalidateResolution might not be needed here but helps currently with issues during\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// multiple parallel queries that mess up the adddedTags state somehow when adding new tags too quick\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twp.data.dispatch('neuwo').invalidateResolution('getData').then(() => {  // Neuwo Datastore gets updated tag ids for keywords\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(\"addedTags\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(addedTags)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"Problem creating a new post_tag via WP Rest API, check the POST request from web browser's Developer Tools' network tab for errors.\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>+</Button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t}\n\n\t\t\t{ (neuwoData.brand_safety && neuwoData.brand_safety.BS_indication) &&\n\t\t\t\t<div id=\"neuwoBrandSafety\">\n\t\t\t\t\t<h4>Brand Safety</h4>\n\t\t\t\t\t<p>{neuwoData.brand_safety.BS_indication}</p>\n\t\t\t\t\t<p><span className=\"neuwo_tag_score\">{neuwoData.brand_safety.BS_score}</span></p>\n\n\t\t\t\t</div>\n\t\t\t}\n\n\t\t\t{ (neuwoData.marketing_categories && \n\t\t\t   neuwoData.marketing_categories.iab_tier_1 && \n\t\t\t   neuwoData.marketing_categories.iab_tier_1.length !== 0) &&\n\t\t\t\t<div id=\"neuwoMarketingCategories\">\n\t\t\t\t\t\t<h4>IAB Marketing Categories</h4>\n\n\t\t\t\t\t\t<h5>Tier 1</h5>\n\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t{neuwoData.marketing_categories.iab_tier_1 && neuwoData.marketing_categories.iab_tier_1.map(cat => (\n\t\t\t\t\t\t\t\t<li key={cat.value}>{cat.ID} {cat.label} <span className=\"neuwo_tag_score\">{cat.relevance}</span></li>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<h5>Tier 2</h5>\n\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t{neuwoData.marketing_categories.iab_tier_2 && neuwoData.marketing_categories.iab_tier_2.map(cat => (\n\t\t\t\t\t\t\t\t<li key={cat.value}>{cat.ID} {cat.label} <span className=\"neuwo_tag_score\">{cat.relevance}</span></li>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t}\n\n\t\t\t</div>\n\t\t\t\n\t\t</PluginDocumentSettingPanel>\n\t)\n}\n\n\nconst NeuwoSimilarityToggleControl = () => {\n\tconst postMeta = useSelect((select) => {\n\t\treturn select('core/editor').getEditedPostAttribute('meta');\n\t})\n\tconst [ loading, setLoading ] = useState(false);\n\tconst [isChecked, setChecked] = useState( postMeta.neuwo_exclude_from_similarity )\n\treturn (\n\t\t<PluginPostStatusInfo>\n\t\t\t<CheckboxControl \n\t\t\tlabel=\"Exclude from Neuwo suggestions\"\n\t\t\tdisabled={loading}\n\t\t\tchecked={isChecked}\n\t\t\tonChange={(newValue) => {\n\t\t\t\tconst postId = wp.data.select('core/editor').getCurrentPost().id\n\t\t\t\t// console.log('setting to ' + newValue)\n\t\t\t\tsetLoading(true);\n\n\t\t\t\tapiFetch({ \tpath: '/neuwo/v1/excludeFromSimilarity', method: 'post', \n\t\t\t\t\t\t\tdata: {exclude: newValue.toString(), postId: postId.toString() }\n\t\t\t\t\t\t}).then((apiData) => {\n\t\t\t\t\t\t\t// console.log(\"Setting updated apiData\");\n\t\t\t\t\t\t\t// console.log(apiData);\n\t\t\t\t\t\t\t\tsetChecked(apiData);\n\t\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t}}\n\t\t\t></CheckboxControl>\n\t\t</PluginPostStatusInfo>\n\t)\n}\n\nregisterPlugin('neuwo-gutenberg', {\n\trender: () => {\n\t\treturn (\n\t\t\t<>\n\n\t\t\t<NeuwoKeywordsControl/>\n\t\t\t<NeuwoSimilarityToggleControl/>\n\t\t\t\t\n\t\t\t</>\n\t\t);\n\t},\n});\n\n\n// Auto update Neuwo view after post edits\n// Has some performance issues while there isn't better official solution yet.\n// REF: https://github.com/WordPress/gutenberg/issues/17632#issuecomment-819379829\n\n/**\n * Consults values to determine whether the editor is busy saving a post.\n * Includes checks on whether the save button is busy.\n *\n * @return {boolean} Whether the editor is on a busy save state.\n */\nfunction isSavingPost() {\n\n\t// State data necessary to establish if a save is occuring.\n\tconst isSaving = wp.data.select('core/editor').isSavingPost() || wp.data.select('core/editor').isAutosavingPost();\n\tconst isSaveable = wp.data.select('core/editor').isEditedPostSaveable();\n\tconst isPostSavingLocked = wp.data.select('core/editor').isPostSavingLocked();\n\tconst hasNonPostEntityChanges = wp.data.select('core/editor').hasNonPostEntityChanges();\n\tconst isAutoSaving = wp.data.select('core/editor').isAutosavingPost();\n\tconst isButtonDisabled = isSaving || !isSaveable || isPostSavingLocked;\n  \n\t// Reduces state into checking whether the post is saving and that the save button is disabled.\n\tconst isBusy = !isAutoSaving && isSaving;\n\tconst isNotInteractable = isButtonDisabled && ! hasNonPostEntityChanges;\n\t\n\treturn isBusy && isNotInteractable;\n  }\n  \n// Current saving state. isSavingPost is defined above.\nlet wasSaving = isSavingPost();\n\nwp.data.subscribe( () => {\n\t// New saving state\n\tconst isSaving = isSavingPost();\n\n\t// It is done saving if it was saving and it no longer is.\n\tconst isDoneSaving = wasSaving && !isSaving;\n\n\t// Update value for next use.\n\twasSaving = isSaving;\n\n\tif ( isDoneSaving ) {\n\t\t/**\n\t\t * Add additional functionality here.\n\t\t */\n\n\t\t// Adding a log to understand when this runs.\n\t\t// const currentDate = new Date();\n\t\t// const time = currentDate.getHours() + \":\" + currentDate.getMinutes() + \":\" + currentDate.getSeconds();\n\t\t// console.log(`${time}Post is done saving via isDoneSaving`);\n\t\t\n\t\t// TODO filter when to fetch new neuwoData\n\t\t// - if post is published\n\t\t// - if neuwoData exists\n\t\twp.data.dispatch('neuwo').invalidateResolution('getData');\n\n\t} // End of isDoneSaving\n\n}); // End of wp.data.subscribe","// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"editPost\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"plugins\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// TODO\nimport './editor.scss';\nimport './sidebar';\n\n"],"names":["addTag","tag","type","populateData","neuwoData","apiFetch","fetchData","postId","FETCH_DATA","resp","path","then","response","getData","wp","data","select","getCurrentPostId","apiData","console","log","state","registerPlugin","PluginDocumentSettingPanel","PluginPostStatusInfo","Button","CheckboxControl","Spinner","useState","useSelect","createReduxStore","register","selectors","actions","resolvers","controls","DEFAULT_STATE","tags","brand_safety","BS_score","BS_indication","marketing_categories","iab_tier_1","iab_tier_2","store","reducer","action","NeuwoKeywordsControl","loading","setLoading","neuwoStore","addedTags","setAddedTags","dispatch","savePost","getCurrentPost","id","length","map","value","score","addedToPost","includes","oldTagIds","getEditedPostAttribute","WPTagId","updatedTagIds","concat","editPost","saveEntityRecord","name","val","newTagId","invalidateResolution","cat","ID","label","relevance","NeuwoSimilarityToggleControl","postMeta","isChecked","setChecked","neuwo_exclude_from_similarity","newValue","method","exclude","toString","render","isSavingPost","isSaving","isAutosavingPost","isSaveable","isEditedPostSaveable","isPostSavingLocked","hasNonPostEntityChanges","isAutoSaving","isButtonDisabled","isBusy","isNotInteractable","wasSaving","subscribe","isDoneSaving"],"sourceRoot":""}